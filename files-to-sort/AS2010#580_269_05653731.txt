Bulan?k Hedef -z Eletirme ile Tek kamera Çoklu Hedef Takibi 
Single Camera Multi-Target Tracking by Fuzzy Target-Track Association 
Umur Ak?nc?1, Uur Hal?c?1, Kemal Leblebiciolu1 
1. Elektrik ve Elektronik Mühendislii Bölümü  
Orta Dou Teknik Üniversitesi 
umurakinci@yahoo.com 
{halici,kleb}@metu.edu.tr  
 
Özetçe 
Bu çal?mada, tek kamera çoklu hedef takibinde hedef ve iz 
eletirme için bulan?k mant?k tabanl? kurallardan oluan bir 
izleyici sisteminin yap?s? ve sonuçlar? aç?klanmaktad?r. 
Önerilen yöntem ile çeitli video veritabanlar?nda testler 
yap?lm? ve bir çok karma?k durum için baar?l? sonuçlar 
al?nm?t?r. 
 
Abstract 
In this study, implementation and results of single camera 
multi-target tracking system based on fuzzy logic rules for  
target-track association is presented. Proposed method has 
been tested with various video databases and successful 
results are obtained for  complex situations. 
1. Giri 
Tek bir kameradan çoklu hedef izleme sistemlerinin birçok 
problemli alanlar? vard?r. Etkili bir hareket bölütleme için 
video görüntülerinde arka plan?n modellenmesi gereklidir. 
Arka plan modelleme, çoklu hedef izleme sisteminin 
gelitirildii uygulama alan?na oldukça duyarl?d?r ve çevresel 
koullar arka plan modelleme için kullan?lacak parametrelere 
yön vermektedir. D? mekanlar?n, iç mekanlara göre artlar? 
farkl?d?r ve arka plan modelleme yöntemi seçimi özel dikkat 
gerektirmektedir. Arka plan modellemeye ek olarak, gölge 
saptama tekniklerinin de uygulanmas? gerekmektedir. Gölgeler 
nesneler gibi hareket ettiklerinden nesne bölütlemenin 
etkinliini azaltmaktad?r. Hareket alg?lama ve nesne bölütleme 
sonucunda analiz edilip muhtemel hedefler olarak tan?mlanan 
piksel gruplar? iz olarak adland?r?lmaktad?r. 
Hedef-iz ilikilendirmesi, çoklu hedef takibi için zorunlu ve 
önemli bir ad?md?r. Takip edilen hedeflerin hangi izler ile 
eletirileceinin etkin bir ekilde belirlenmesi kritiktir. 
Tek bir kamera için izleme sistemlerinin kar?lat?? önemli bir 
darboaz s?k gerçekleen hedef kesimeleridir. Boyut, renk, 
ekil, rota gibi hedeflerin bilgilerini kullanma takip 
algoritmalar?n?n hedef kesimesi durumlar?na tepkilerini 
gelitirir. 
Bu çal?mada, tek kamera çoklu hedef takibinde hedef-iz 
eletirme için bulan?k mant?k kullanan bir yöntem 
önerilmektedir. Yöntem ve elde edilen sonuçlar aa?daki 
bölümlerde verilmitir. 
2. Önerilen Yöntem 
Tek kamera çoklu hedef takibi problemi için önerilen 
yöntemin blok emas? ekil 1’de verilmitir. Detaylar aa?da 
aç?klanm?t?r. 
 
 
ekil 1Önerilen Methodun Blok emas? 
2.1. Arkaplan Modelleme 
Bu çal?mada, arkaplan modelleme için GMM (Gaussian 
Mixture Model) kullan?lm?t?r. Metodun detaylar? [1-7] de 
incelenebilir. GMM tabanl? modelleme parametrelerinin, 
özellikle örenme oran? parametresinin, sahne özelliklerine 
göre dikkatle ayarlanmas? gerekmektedir.  
2.2. Gölge Saptama 
Gölge saptama hareket bölütlemede önemli bir ad?md?r. 
Genellikle, koyu gölgelerin bulunduu durumlarda, hareketli 
hedefler yanl? alg?lanmaktad?r. Hareketli hedeflerin yanl? 
Video 
görüntüleri 
Arkaplan 
modelleme 
Çoklu Hedef 
zleri 
Gölge 
saptama 
Hedef Analizi 
z ç?karma 
Hedef – iz eletirme 
53
SIU2010 - IEEE 18.Sinyal isleme ve iletisim uygulamalari kurultayi - Diyarbakir
978-1-4244-9671-6/10/$26.00 ©2010 IEEE
bölütlenmesi ise birden çok hedefin birlemesine veya hedefin 
yanl? lokalizasyonuna neden olabilir. Bu çal?mada kullan?lan 
gölge saptama yöntemlerinin detaylar? [8] [9] ve [10]’da 
aç?klanmaktad?r. 
2.3. Hedef Analizi 
Arka plan modellemeden sonra, her bir kare arka plan model 
ile kar?lat?r?l?r ve ön plan bölgeleri ay?klan?r. Gölge saptama 
aamas?nda ön plan bölgeleri incelenir ve hareketli 
piksellerden gölgeye ait olanlar belirlenir. Tespit edilen gölge 
bölgeleri ve nesne bilgilerinden oluan gri tonlu görüntü hedef 
analizi aamas?na aktar?l?r. Hedef analizi aamas?nda aa?daki 
ad?mlar vard?r: 
• Öncelikle, gürültü piksellerinin filtrelenmesi ve ufak 
aç?kl?klar?n kapat?lmas? için morfolojik operasyonlar 
uygulan?r. 
• Görüntü üzerindeki birleik piksel bölgeleri 
taranarak, her bölgeye bir numara verilir. 
• Her bir bölge için, boyut, en boy oran? ve doluluk 
oran? kontrol edilir. Kurallara uymayan bölgeler 
dikkate al?nmaz ve kurallara uyan bölgeler iz olarak 
adland?r?l?p, numaralan?r. 
• Her bir iz için, 2.3.1’de verilen görüntü momentleri 
ve izdüüm histogram? hesaplan?r. Görüntü 
momentlerini kullanarak, izlerin a?rl?k merkezleri, 
ana eksene olan yönelimleri hesaplan?r. zdüüm 
histogramlar? kullan?larak izlerin ayr?ma durumlar? 
incelenir. 
2.3.1. Görüntü Momentleri 
Yaln?zca nesnelere ait (gölge olmayan) bölgeler kullan?larak 
hedeflerin ham momentleri aa?da verilen formül ile 
hesaplan?r:  
 
(1) 
Burada I(x,y) görüntü younluudur.  
Momentleri kullanarak, hedeflerin a?rl?k merkezleri ve ana 
eksene olan yönelimleri hesaplan?r. Görüntü a?rl?k merkezi 
aa?daki formül ile tan?mlanmaktad?r: 
      
(2) 
Merkezi momentleri tan?mlayan formül aa?da verilmitir: 

(3) 
Görüntü yönelimini hesaplayabilmek için öncelikle ikincil 
merkezi momentleri kullanan kovaryans matrisini hesaplamak 
gerekmektedir. Kovaryans matrisi: 

(4) 
Burada, 
 (5) 
 (6) 
 (7) 
olarak tan?mlanmaktad?r. Kovaryans matrisinin özvektörleri 
ana ve yan eksenleri tan?mlamaktad?r. Ana eksene yönelim ise 
aa?daki formül ile tan?mlanmaktad?r: 

(8) 
2.4. zleyici 
Bu çal?mada önerilen izleyici (tracker) Kalman Filtresi 
tabanl?d?r. Hedef analizi aamas?nda alg?lanan hedefler ile izler 
aras?nda ilikilendirme 2.5’de tan?mland?? gibi yap?l?r. Eer 
alg?lanan hedef için ilikilendirilen bir iz bulunamasa yeni bir 
iz oluturulur. Her bir iz için aa?daki bilgiler tutulur: 
• Her iz için bir kimlik numaras? 
• En son eletirilen hedefin kaplad?? alan, 
• En son eletirilen hedefin ana eksene yönelimi, 
• En son eletirilen hedefin renk histogram?, 
• En son eletirilen hedefin s?n?r kutusu, 
• Kalman Filtre parametreleri 
• z istatistikleri 
o Takip edilen toplam görüntü karesi say?s?, 
o Hedef eletirilemeyen görüntü karesi say?s?, 
o En son hedef eletirme zaman?, 
Eer alg?lanan hedef ile eleen iz bulunursa, iz bilgileri ve 
Kalman Filtre bu hedef kullan?larak güncellenir. 
Her görüntü karesi ileniinde, her bir iz: 
• Görüntü s?n?rlar? ile kar?lat?r?l?r. Görüntü s?n?rlar? 
d??na ç?kan izler silinir.  
• Arka arkaya eletirilememe durumuna kar? kontrol 
edilir. Bir iz, ard??k olarak belirli bir eikten fazla 
say?da görüntü karesinde eletirilemediyse silinir. 
• lk ilikilendirme durumuna kar? kontrol edilir. Eer 
bir iz tan?mland??nda belirli bir eik deerinden daha 
çok görüntü karesinde bir hedef ile eletirilemezse 
silinir. Eer bir iz herhangi bir hedef ile 
eletirilemese, tahmin edilen durumu ile güncellenir. 
2.5. Hedef-z Eletirme 
Bu aamada, hedef analizi aamas?nda elde edilen hedefler ile 
izleyici aamas?ndaki izler kullan?l?r. Tüm hedefler ve izler 
için detaylar? aa?da verilen bulan?k mant?k kurallar? 
uygulanarak bir hedef-iz ilikilendirme deeri hesaplan?r. Elde 
edilen bu hedef-iz ilikilendirme deerine göre her bir hedef 
için aa?daki kontroller gerçekletirilir: 
• Hedef-iz ilikilendirme deeri, belirli bir eik 
deerinden büyük olan izler ilikilendirme listesine 
eklenir. En yüksek deerli izden balanarak hedefler 
arat?r?l?r. 
o Eer eletirme listesinde bir iz yoksa, o hedef için 
yenir bir iz balat?l?r. 
o Eer eletirme listesinde bir iz varsa; 
 O iz için daha yüksek eletirme deerine 
sahip baka bir hedef yoksa eletirme 
gerçekletirilir. O iz bu hedef ile eletirilir. 
 O iz için daha yüksek eletirme deerine 
sahip baka bir iz varsa ayr?ma gerçeklemi 
demektir. Bu hedef için yeni bir iz balat?l?r. 
54
SIU2010 - IEEE 18.Sinyal isleme ve iletisim uygulamalari kurultayi - Diyarbakir
o Eer eletirme listesinde birden çok iz varsa her 
bir iz için; 
 O iz için daha yüksek eletirme deerine 
sahip baka bir iz varsa listedeki bir sonraki iz 
incelenir. 
 O iz için daha yüksek eletirme deerine 
sahip baka bir hedef yoksa ve iz s?n?r kutusu 
ile hedef s?n?r kutusu çak??yorsa birleme 
sayac? bir art?r?l?r. 
 Eer listede baka bir iz yoksa ve birleme 
sayac?; 
• 1’den büyükse bu bir birleme durumudur. 
Birlemi hedef için bir iz balat?l?r. 
• 1’e eitse hedef-iz eletirmesi yap?lm?t?r. 
z bu hedef ile güncellenir. 
• 0’a eitse eletirme yap?lamam?t?r. Hedef 
için yeni bir iz balat?l?r. 
2.5.1. Bulan?k Eletirme Deeri 
Bulan?k eletirme, Üyelik Fonksiyonlar? üzerinde "Eer ... 
ise, o zaman ...." biçimindeki kurallar uygulanarak elde 
edilmektedir. Bulan?k Mant?k ile ilgili detaylara kaynak 
[11]’den ula?labilir. 
Her bir hedef-iz çifti için, bulan?k eletirmede kullan?lan 
eletirme deeri üç giriten hesaplan?r: 
• Hedef a?rl?k merkezi ile iz a?rl?k merkezi 
aras?ndaki mesafe, 
 
ekil 2 Mesafe Yak?nl?? Bulan?klat?rmas? 
Tam Pozisyon:  TP := (0, 0) (0, 1)  (5, 1) (10, 0)  
Çok Yak?n  ÇY := (5, 0) (10, 1) (25, 0) 
Yak?n  Y := (10, 0) (25, 1) (45, 0) 
Uzak  U   := (15, 0) (45, 1) (65, 0) 
Çok Uzak ÇU  := (45, 0) (65, 1) (500, 1) (500, 0) 
 
• Hedef alan?n?n iz alan?na oran? 
 
ekil 3 Alan Uyum Oran? Bulan?klat?rmas? 
Az Alan Uyumu AAU := (0, 0) (0, 1)  (0.2, 1) (0.4, 0) 
Orta Alan Uyumu OAU:= (0.2, 0) (0.4, 1) (0.6, 0) 
Büyük Alan Uyumu BAU:= (0.4, 0) (0.6, 1) (0.8, 0) 
Yak?n Alan Uyumu YAU:= (0.6, 0) (0.8, 1) (0.9, 0)  
Tam Alan Uyumu  TAU := (0.8, 0) (0.9, 1) (1, 1) (1,0) 
• Hedef ve z Renk histogramlar? aras?ndaki 
Bhattacharyya mesafesi  
 
ekil 4 Renk Uyum Oran? Bulan?klat?rmas? 
Tam Renk Uyumu TRU := (0, 0) (0, 1)  (0.25, 1) (0.35, 0) 
Yak?n Renk Uyumu YRU := (0.25, 0) (0.35, 1) (0.45, 0) 
Büyük Renk Uyumu BRU := (0.35, 0) (0.45, 1) (0.55, 0) 
Orta Renk Uyumu ORU := (0.45, 0) (0.55, 1) (0.65, 0) 
Az Renk Uyumu ARU := (0.55, 0) (0.65, 1)  (1, 1) (1, 0) 
Bu üç bulan?k girii, ç?k? durumlar?na eletiren 124 kural 
yarat?lm?t?r (EY : Eleme Yok, UE : Ufak Eleme, OE : 
Orta Eleme, YE : Yüksek Eleme, ÇYE : Çok Yüksek 
Eleme, TE : Tam Eleme). Bu kurallardan baz?lar? aa?da 
verilmitir: 
 
KURAL  0 :   Eer TP ve AAU ve TRU ise, o zaman YE'dir 
KURAL 10 :  Eer TP ve AAU ve TRU ise, o zaman TE'dir 
KURAL 20 :  Eer TP ve TAU ve TRU ise, o zaman  TE'dir 
KURAL 30 :  Eer ÇY ve TAU ve TRU ise, o zaman OE'dir 
KURAL 50 :  Eer Y   ve AAU ve TRU ise, o zaman UE'dir 
KURAL 75 :  Eer U   ve AAU ve TRU ise, o zaman UE'dir 
KURAL 90 :  Eer U   ve YAU ve TRU ise, o zaman YE'dir 
KURAL 105: Eer ÇU ve OAU ve TRU ise, o zaman EY'dir 
KURAL115:  Eer ÇU ve YAU ve TRU ise, o zaman UE'dir 
KURAL 120: Eer ÇU ve TAU ve TRU ise, o zaman  OE'dir 
KURAL 121: Eer ÇU ve TAU ve YRU ise, o zaman  UE'dir 
KURAL 124: Eer ÇU ve TAU ve ARU ise, o zaman  EY'dir 
 
3. Sonuçlar 
Bu çal?mada anlat?lan algoritma, Pets video veritabanlar?nda 
[12] (Pets2001, Pets2004, Pets2006 ve Pets2007) denenmitir. 
ekil 5’de elde edilen sonuçlardan bir seri görsel inceleme için 
sunulmutur. Üst s?ra hedef ve iz takibi sonuçlar?n?, alt s?rada 
arka plan modelleme ve gölge saptama sonuçlar?n? 
vermektedir. Her bir görüntü karesi zamanda farkl? bir aral??, 
belirtmektedir (zaman aral?klar? eit deildir). (a) karesinde 
saptanan 1, 2, 3 no’lu hedefler (e) karesine kadar takip 
edilmektedir. 
55
SIU2010 - IEEE 18.Sinyal isleme ve iletisim uygulamalari kurultayi - Diyarbakir
  (a) (b) (c) (d) (e) 
 
(f) (g) (h) (i) (j) 
ekil 5 Pets2006 Görüntü Veritaban? Sonuç Örnei  
Bu arada 1 ve 2 no’lu hedefler birleme ve ayr?lma durumlar? 
ile kar?lamas?na ramen takibe devam edilmitir. (d) 
karesinde 1 ve 2 no’lu hedeflerden oluan birleik hedefe 
ayr?ca 4 no’lu iz etiketi eklenmitir. (f) karesinde izleyici 1 
no’lu izden ayr?lan hedefe 5 no’lu iz etiketini eklemitir. (e) 
karesinden (h) karesine kadar 2 no’lu iz, 4 ve 5 no’lu izler ile 
birleme ve ayr?lma durumlar? yaamas?na ramen düzgün bir 
ekilde izlenmitir. (a)-(j) karelerinde 2 no’lu iz sürekli ve 
ayn? etiket ile takip edilebilmitir. 
4. Planlanan Çal?malar 
Bu çal?mada tek kamera üzerindeki çoklu nesne takibi 
deerlendirilmitir. Nesnelerin birbirlerini kapatmas? problemi 
tek kamerada çal?an izleyici sistemlerinin en büyük 
sorunlar?ndan biridir. Bu sorunu amak için çoklu kamerada 
çoklu hedef takibi çal?malar?n? balatm? bulunuyoruz. Çoklu 
kamera içeren çal?mada,  Pets veritabanlar?nda halihaz?rda 
mevcut olan çoklu kamera videolar? kullan?lacakt?r. 
Gelitirdiimiz izleyicinin çoklu kameraya uygulanmas? ve her 
bir kamera için elde edilen iz ve hedef bilgisinin birletirilerek 
kullan?lmas?yla daha güvenilir bir izleyici oluturmay? ümit 
etmekteyiz. Baar?n?n art?r?lmas? amac?yla, kamera kalibrasyon 
parametreleri yard?m?yla nesnelerin tabandan yüksekliklerini 
elde ederek, bunlar? da hedef analizi ve izleyici aamalar?ndaki 
deerlendirmelere dahil etmeyi planlamaktay?z. 
5. Kaynakça 
[1] V. M. Ioannis Pavlidis, Panagiotis Tsiamyrtzis, And 
Steve Harp, "Urban Surveillance Systems: From the 
Laboratory to the Commercial World," 2001. 
[2] A. A. Christopher Richard Wren, Trevor Darrell, and 
Alex Paul Pentland, "Pfinder: Real-Time Tracking of the 
Human Body," 1997. 
[3] Z. Zivkovic, "Improved Adaptive Gaussian Mixture 
Model for Background Subtraction," 2004. 
[4] R. K. Qi Zang, "Robust Background Subtraction and 
Maintenance," 2004. 
[5] H. W. a. D. Suter1, "A Novel Robust Statistical Method 
for Background Initialization and Visual Surveillance," 
2006. 
[6] C. G. Stauffer, W.E.L, "Adaptive background mixture 
models for real-time tracking," CVPR, 23-25 June 1999 
1999. 
[7] P. K. a. R. Bowden, "An Improved Adaptive Background 
Mixture Model for Realtime Tracking with Shadow 
Detection," 2nd European Workshop on Advanced Video 
Based Surveillance Systems, 2001. 
[8] D. H. Thanarat Horprasert, Larry S. Davis, "A Statistical 
Approach for Real-time Robust Background Subtraction 
and Shadow Detection," IEEE Int’l Conf. Computer 
Vision, 1999. 
[9] C. G. R. Cucchiara, G. Neri, M. Piccardi, A. Prati, "The 
Sakbot System for Moving Object Detection and 
Tracking," 2001. 
[10] I. Haritaoglu and D. H. a. L. S. Davis, "Real-Time 
Surveillance of People and Their Activities," 2000. 
[11] J. M. MENDEL, "Fuzzy Logic Systems for Engineering: 
A Tutorial," 1995. 
[12] PETS: Performance Evaluation of Tracking and 
Surveillance, http://www.cvg.rdg.ac.uk/slides/pets.html 
 
2 2 
2 
2 
5 
2 
4 
5 
2 
4 
5 
1 
4 
2 
4 
5 
5 
3 
1 
3 3 
2 
1 
1 
4 
2 
3 
2 
3 
4 
56
SIU2010 - IEEE 18.Sinyal isleme ve iletisim uygulamalari kurultayi - Diyarbakir
