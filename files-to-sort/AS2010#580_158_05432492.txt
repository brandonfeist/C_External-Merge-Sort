  
Research of Outlier Mining Based Adaptive Intrusion Detection Techniques 
Fang Yu Ke, Fu Yan, Zhou Jun Lin 
School of Computer Science and Engineering 
University of Electronic Science and Technology of China 
Chengdu, P. R. China 
e-mail: fangyuke@uestc.edu.cn; fuyan@uestc.edu.cn; jlzhou@uestc.edu.cn 
Abstract—The traditional IDS can not effectively manage the 
new continuously changing intrusion detection attacks. To 
deal with the problem, data mining based intrusion detection 
methods have been the hot fields in intrusion detection 
research. An outlier mining based adaptive intrusion detection 
framework is proposed in this paper. In the proposed 
framework, the outliers are firstly detected by similarity 
coefficient. And then, the clusters are built on the detected 
outlier data set and the improved association rule algorithm is 
employed on the clusters. Finally, the rules generated by 
association rule algorithm will be adaptively added into the 
current intrusion detection rule base. The experiments 
performed on simulated data and KDD99 from UCI data set 
have shown the effectiveness of proposed methods.  
Keywords-Artificial intelligence; Intrusion detection; 
Outlier mining; Anomaly detection; Self -Adaptive 
I. INTRODUCTION 
Existing intrusion detection systems are two main 
categories: Signature-based misusing detection or 
rule-based detection such as Snort; the other is 
anomaly-based detection, or behaviour-based such as 
MADAM ID, LERAD. However, they both have limited 
usefulness. The misusing detection has good efficient and 
low false positives, but there exist the problem of signature 
update, intrusion varieties and high missing rate; Anomaly 
based detection have better generality, especially it can 
detection unknown intrusion, yet this method have high 
false alarm rate, it’s difficulty to analysis whether the 
anomaly come from the intrusion, furthermore, is the 
problems of concept drifting and pseudo attack.  
 The anomaly detection mines the intrusion pattern by 
detecting the system abnormal behaviours. Although there 
exists much limitation in practical application, it will play 
important role in the intrusion detection if we have broken 
through in efficiency and accuracy. Also, as Julish 
decrypted in [1], the anomaly detection based on data 
mining has an unpractical assumption: the availability and 
quality of the train set. Because the environment of the IDS 
changes dynamically with the time, it’s an absolute 
essential that the IDS model is self adaptive, and then the 
IDS would have a good performance for long time. 
 This paper builds an intelligent IDS model by using 
the sophisticated algorithms in machine learning. 
Furthermore, the self-adaptive intrusion detection 
framework first make the anomaly detection in intrusion 
behaviour, and then, introducing the outlier mining, 
clustering and association analysis to efficiently detect 
unknown attraction behaviour. 
II. OUTLIER MINING IN INTRUSION DETECTION 
 Outlier mining is an important research branch in data 
mining; its task is to find small groups of data objects that 
are exceptional when compared with rest large amount of 
data. Outlier Mining can be decrypted two steps: (1) given a 
dataset, how to define the exceptional conception and 
what’s it; (2) how to dig the outliers efficiently. 
 In this paper, an algorithm for outlier detection based 
on similar coefficient sum is applied [2]. The algorithm is 
decrypted as follow. 
 Given the domain 1 2{ , ,..., }nX x x x , for any 
element 1 2{ , ,..., }, (1,2,..., n)i i i imx x x x i  , with the matrix 
representation as shown in formula (1), Our goal is to find 
the n outliers set in X. 
11 12 1
21 22 2
1 2
...
...
...
...
m
m
n n nm
x x x
x x x
X
x x x
ª º« »« » « »« »¬ ¼
        (1) 
 In order to find the dispersion of every object of X, we 
calculate the similar coefficients between all objects and 
obtain the similar coefficients matrix R . 
2010 Third International Conference on Knowledge Discovery and Data Mining
978-0-7695-3923-2/10 $26.00 © 2010 IEEE
DOI 10.1109/WKDD.2010.51
552
  
11 12 1
21 22 2
1 2
...
...
...
...
n
n
n n nn
r r r
r r r
R
r r r
ª º« »« » « »« »¬ ¼
         (2) 
2
1
11 ( )
m
ij ik jk
k
r x x
n  
  ¦            (3) 
1
n
i ij
j
p r
 
 ¦                        (4) 
Where, ip is the i-th row sum of the matrix, the less 
sum value, the longer distance from object i to others, i.e. 
object i maybe the candidate of the outlier set. 
max
max
i
i
p p
p
O                      (5) 
Where,O  is the threshold, the object which meets the 
condition iO >=O can be outlier. 
 The efficiency and accuracy is the primitive 
requirement of the outlier mining algorithm in intrusion 
detection, therefore, the above algorithm uses O (n2) time, if 
applied in the real-time IDS directly, and it can have impact 
on the real-time process of detection. Beyond that, the web 
data is continual and changing dynamically. And so, an 
improved algorithm based on width fixed moving window 
method is proposed in this paper. The window width is the 
fixed data packet number w, the moving unit i, when new i 
packets reach, the window slide a unit packets. 
Two points are worth noting. One is the data 
pre-process with standardization and normalization 
methods. The other is that theO  will directly affect the 
quality of the outlier detection. The small O will result in a 
high false detection rate; in contrast, the highO will give a 
high false negative rate. The higherO is set in actual use, 
and so, system will initially have a higher false negative 
rate, however, with following self-adaptive algorithm, the 
system can learn the potential association from the detected 
outliers, and by applying the association, the false negative 
rate will reduce gradually. 
III. SELF-ADAPTIVE IDS FRAMEWORK 
 When the outliers of the network activity are found by 
outlier mining, if applying association analysis to these 
detected irregular outliers, not only do the threshold of 
association analysis algorithm set difficultly, but also this 
algorithm has little effect in the detection of the abnormal 
network data packets. Therefore cluster algorithm are 
applied to the detected outliers firstly, and then, the 
improved association analysis is employed on the clusters 
and extract the potential association to generate the rule 
set[3], furthermore, convert the rules into specific rules 
which the IDS can use directly, and so the system has the 
advantages of self adaptability finally. 
A. Improved Apriori algorithm 
 The improved association rule AprioriTid [5] is used 
in this paper. The whole association analysis consists of 
three steps: data preprocess, association rules generating 
and rules conversion. 
1) Data Pre-process: The input data maybe are log records 
or network data packets generated by IDS, in general they 
contain many attribute fields, however not all fields are suit 
to association analysis. 
2) Association Rules Generating: AprioriTid is used to 
find all the frequent item set and the association rules, and 
there are two parameters (support and confidence) in 
AprioriTid. Normally, the higher support, the more frequent 
items generated; the higher confidence, the more accurate 
the association rules. 
3) Rules Conversion: Generally speaking, the above 
association rules can’t be applied directly into specific IDS 
before rules conversion because of their inconsistent rule 
syntax. Take for example, Snort, its detection rules consist 
of rule head and rule option. The rule head contains process 
type, protocol type, source IP address, source port etc, and 
the rule option contains data content and data packet option, 
and so on. When rules conversion, the fields in association 
rules which are relevant to the Snort rule head and rule 
option are put together and form new rules Snort can use. 
B. Self-adaptive IDS Framework based on outlier mining 
 In this work, self-adaptive IDS framework based on 
outlier mining is built according to the AMG (Adaptive 
model generation) proposed by Eskin[4]. And the whole 
framework is shown in Figure-1. 
At first, the Sniffer captures data packet of network 
and supplies to the intrusion detection engine which detect 
whether the invasion of the activities of the packets 
according to the rule set. If it is intrusion, then tags the data 
label and adds the labelled data into the outlier mining 
dataset; if not, put the data into the dataset directly. Here, 
553
  
the label is to indicate whether the packet is anomaly and 
will be used in the later cluster. And the DBSCAN [6] is 
used to cluster the outlier set. Then, AprioriTid is employed 
for each cluster to discover the potential association rules in 
all attributes of abnormal network data packets. Finally, the 
discovered association rule will be converted into the rule 
IDS can use directly. 
Data 
captured by 
Sniffer
Standardizatio
n and 
normalization
Anomaly 
detection with 
outlier mining
Is Outlier
IDS
Is Abnormal 
Data
No, unlabelled 
data
Alert Yes
No Over
Association 
analysis with 
AprioriTid
Yes
Rule 
conversion
Add the rule 
into Snort 
ruleset
Intrusion 
Detection 
Ruleset
Outlier 
detection 
data set
Labelled 
data
Outlier 
set
Clustering the 
outliers with 
DBSCAN
Is Outlier number 
over the 
threshold
Yes
No
 
Figure 1. Self-adaptive IDS Framework based on outlier mining 
IV. EVALUATION 
 The experiment consists of two parts. The first is used 
to show the validity of the proposed outlier mining 
algorithm based on KDD99 of UCI dataset; in the other 
experiment, the platform was based on IDS Snort and IDS 
Informer was employed to simulate the attack and test. 
A. Experiment of outlier mining 
In the KDD cup99 dataset, each record consists of 41 
discrete or continuous attributes (e.g.: connection duration, 
protocol type, etc.) and the class type (normal and the detail 
attack type such as Probe, R2L, U2R and DoS and etc.).Not 
all the attributes are useful for the detection, Srinivas 
Mukkamala et al. [7] indicated that the most important 
attributes of the KDD99 dataset are the 13 attributes such as 
duration, src_bytes, same_srv_rate, dst_host_count, urgent, 
dst_host_same_src_port_rate, dst_bytes, srv_count, count, 
dst_host_srv_count, dst_host_same_srv_rate, protocol_type 
and service, where the field attributes are discrete or 
continuous, and this experiment is based on the 13 
attributes. In the experiments, there are 4 group data set 
which contains 100000 normal records and 5000 intrusion 
records for each attack type, and the parameters are set as 
follows: window_width=1000, slide_unit=10, the 
experiment is shown in Table 1. The proposed outlier 
mining algorithm has an excellent detection and false-alarm 
rates on the Dos and Probe attack types; instead, for the 
R2L and U2R, the result is not satisfactory. However, in the 
KDD99 cup, the detection and false-alarm rates of the 
winner’s algorithm were 13.2% and 8.4% respectively. 
TABLE I. Detection result on the same intrusion data with the different 
O (DR: Detection Rate; FAR: False Alarm Rate) 
DOS R2L U2R Proble O
DR FAR DR FAR DR FAR DR FAR
6 100 4.2 45.1 4.2 38.1 5.52 100 4.18
7 100 4.1 40.2 3.6 33.4 4.52 100 3.0 
8 100 3.9 40.1 2.46 28.7 4.49 100 2.34
9 100 2.5 35.0 1.23 19.1 3.58 100 1.63
10 95 1.5 24.5 0.2 14.3 2.04 100 0 
11 0 0 12.7 0 4.76 1.43 100 0 
B. Experiment of Self-Adaptive IDS 
 Snort was used as the platform IDS because of its 
lightweight open source and scalability. And the outlier 
mining and association analysis modules were integrated 
into Snort with the form of intelligent plugin so that Snort 
can detect the unknown intrusion activity. 
 In the experiment, 11 basic attributes(source ip and 
port, destination ip and port ,protocol type, data field length, 
Tcp flags (4 fields) )and 5 extension attributes(connection 
duration, connection frequency, data payload length, 
payload mean, payload variance) were selected for the 
outlier mining and cluster. Because the Snort rule set only 
contains the basic attributions, the association analysis only 
based on the basic attributions. The parameters were set as 
follows: O =9, window_width=1000, slide_unit=10, 
support=20%, confidence=80%. Snort and IDS Informer 
was deployed on 192.168.10.10 and 192.168.10.20 
respectively. Only parts of the result were listed in Figure.2 
and Figure.3 for the limitation of space. 
554
  
 
Figure 2. Two exported rules examples with outliers mining algorithm 
for the IDS Informer attack data 
 
Figure 3. IDS Detection results for the variant attack of IDS Informer 
with the exported rules. 
The new IDS can generate association rules by 
anglicizing the log records with feature generator. Further 
more, the rules were converted into Snort detection rules so 
that Snort is capable to detect the known attack variants and 
unknown attack. 
V. CONCLUSION 
We have proposed a novel algorithm of self-adaptive 
intrusion detection based on outlier mining which integrates 
the association analysis of outlier data and intrusion 
detection. Experimental results show that the proposed 
self-adaptive IDS is able to detect unknown attack more 
efficiently and accurately. Our future work will focus on 
the improvement of outlier mining algorithm. 
ACKNOWLEDGEMENTS 
This work was supported by the National Science 
Foundation of China under Grant No. 60973120 and No. 
60903073, by the National High-Tech Research and 
Development Plan of China under Grant No. 
2007AA01Z440, by Research and Development Project on 
Application Technology of Sichuan under Grant No. 
2008GZ0009. 
REFERENCES 
[1]. Julish K, Data mining for intrusion detection: A critical review, 
IBM, Kluwer, Boston, MA, Res. Rep. RZ 3398, Feb. 2002. No. 
93450. 
[2]. Prakobphol Zhan K J. A Novel Outlier Detection Scheme for 
Network Intrusion Detection Systems, ICISA 2008.  
[3]. Wenke L. Applying data mining to intrusion detection: the quest for 
automation, efficiency and credibility, ACM SIGKDD Explorations 
Newsletter,2002,Volume 4,Issue 2. 
[4]. Eskin E, Miller M, Zhong Z, et al. Adaptive model generation for 
intrusion detection, ACMCCS Workshop on Intrusion Detection and 
Prevention, Athens, Greece, 2000.  
[5]. Agrawal R, Srikant R. Fast Algorithm for Mining Association Rules, 
Proceedings of 20th Int. Conf, pp. 487-499 
[6]. Ester M, Kriegel HP, Sander J, Xu X. A density based algorithm for 
discovering clusters in large spatial databases with noise. 
Proceedings of the 2nd International Conference on Knowledge 
Discovery and Data Mining. Portland: AAAI Press, 1996. 226~231. 
[7]. Mukkamala S, Sung A H. Feature Selection for Intrusion Detection 
using Neural Networks and Support Vector Machines, Journal of 
Network and Computer Applications, 2005. 
555
