The Research on the Application of Association Rules Mining Algorithm in 
Network Intrusion Detection 
 
Ye Changguo 
Department of Information 
Science and Technology, Taishan 
College, Taian, China, 271021 
yechangguo@tom.com 
Wei Nianzhong 
Department of Information  
Science and Technology,  Taishan 
College, Taian, China, 271021 
wnianzhong@126.com 
 Wang Tailei 
Department of Information  
Science and Technology, Taishan 
College, Taian, China, 271021 
wangtailei@126.com
 
Zhang Qin 
Department of Information Sci.&Eng.,Shandong 
University of Science and Technology,  
Taian, China, 271000 
qin.zh@163.com 
 
Zhu Xiaorong 
Department of Information  
Science and Technology, Taishan College,  
Taian, China, 271021 
smile_nine@126.com 
Abstract—Network Intrusion Detection System (IDS), as 
the main security defending technique, is second guard for 
a network after firewall. Since it can discern and respond 
to the hostile behavior of the computer and network 
resource, it is a hot area for research network security 
nowadays. Data mining technology is applied to the 
network intrusion detection, and Precision of the detection 
will be improved by the superiority of data mining. In this 
paper, there is an example running to contract two 
algorithms. The result is that the fuzzy rule mining 
algorithm is more convenient than Apriori algorithm to 
mine mass network log database.  
Keywords-data mining?association rule?  intrusion 
detection? algorithm 
I. THE DEVELOPING BACKGROUND OF ASSOCIATE 
RULES MINING ALGORITHM 
With the popularity of network, more and more 
people begin to accept Network and use it. They obtain 
and exchange their needing knowledge and information, 
and issue information through network. At the same 
time, the safety problem is getting more and more 
people's attention. The process of transmitting 
information conceals latent danger of being letting out. 
The rapid growth and developing hacker technology 
makes the host more easily be attacked. If the user can 
distinguish whether the visit of unknown hacker or 
unknown host to user's host is normal or abnormal visit, 
the user can take the measure to avoid the host being 
attacked by hacker or unknown hosts. So, to figure out 
whether the system is attacked and give the 
corresponding measure seems extremely important. The 
invading detection is another new safety protection 
technology after the traditional safety protection 
measures like: firewall, date code etc, which functions to 
identity and response the evil action of network. The 
study of the invading detection is foundation to further 
study network safety problem, and assurance and 
premise of solving network safety problem. With the 
development of information times, the data amount is 
increasing rapidly in our daily life. The staff 
management of the companies, the sales performance of   
Retail Industry, the information management of bank 
account, the catching of network data, etc, all this shows 
the rapid growth of date amount. The data mining was 
developed in this background, once it came into being, it 
developed quickly. At the moment the data mining 
technology is still a new-tech. Within short tens years its 
application has involved into a lot of field as bank, retail 
sales, customers management, search engine and 
network safety. 
Associate rules mining is one very common used 
method, with Associate rules mining, the high credited, 
more meaningful rules can be abstracted from big data 
storage with a lot of data, so as to attain the goal of data 
mining and data obtaining. According to the variety of 
attribute getting, associate rules mining can be divided 
into Boolean Associate rules and Multi-valued Attribute 
associate rules. In Multi-valued Attribute associate rules 
mining the attributes values is divided into different 
spaces; and the precision division of the spaces can 
cause the contrast of the spaces border, so as to cause 
the info of the of the bordering be lost . So we lead in 
the fuzzy set theory, change multi-valued attribute into 
fuzzy interval, so as to make the transition between 
intervals smooth, and reduce the information loss 
phenomenon between intervals. So, for the database of 
Multi-valued attribute, we can obtain more and more 
meaningful rules using method of fuzzification to the 
attribute. 
2009 First International Workshop on Education Technology and Computer Science
978-0-7695-3557-9/09 $25.00 © 2009 IEEE
DOI 10.1109/ETCS.2009.451
849
II. ASSOCIATE RULES' APPLICATION IN INVADING 
DETECTION 
To assure the invading detection system certain 
degree's intelligence is the people’s long-time pursue. 
There are already several technology applied into it, 
like: the data mining method of choosing useful data 
with certain intelligent system from big amount data; 
the genetic evolution algorithm of individual survival of 
the fittest coping creatures' evolution; the Neural 
Networks of self- study. Self-fitting ability and even 
tolerate the technology of serving in invasion on the 
network of avoiding the invading virus coping the 
human's immune system. All these, having no doubt 
offer better foundation and option. However as the 
system's main invading prototype is stable, it is only 
possible to enlarge through human method, and can't  
make right judge to big amount of invading action 
without invading prototype so as to cause False 
Negatives. 
In order to overcome the shortage of the traditional 
method mentioned above, the invading detection 
system of cooperating mining technology appears ,and 
associate rules is one of the most important and 
fundamental method. As the strong tool analyzing 
involving relations among data, the Associate Rules has 
shown outstanding priority in mould identifying and 
classifying and forecasting in recent years. Through 
continuous study, IDS can find the rules from the big 
amount complicated data of unknown moulds; the study 
shows the Associate Rules fits the requirements of the 
invading detection system in conception and dealing 
method. 
There three shortages of leading the traditional 
Associate Rules “Apriori algorithm” into invading 
detection system field, one is it produce a lot of pre-
elected item set, specially the 2-itemset. If there is 1000 
continuous 1-itemsets, then it will produce 100000 
order of magnitude's pre-elected 2-itemset. The 
database check a very big pre-elected groups through 
pattern matching, this is very hard to do for the 
invading detection big amount data. Second it needs to 
repeating scanning database, if repeating item sets' 
figures is very big ,then it will repeat the scanning 
many more times, This to the big data of invading 
detecting database, the time needed is very much. 
Thirdly, this algorithm believes each items of the 
database is equally important, but in fact, each items in 
invading detecting does not equal important, we often 
consider the more influential items and ignore the less 
influential items. Additionally, with the time goes by 
and mutation of attacking moulds, the Associate Rules 
caused by longer time's affairs will obsolete, and the 
Associate Rules caused by the affair with shorter 
intervals has though not much support, but reflect the 
new attacking trend. The data which grows with time in 
Auditing data getting more and more, and caused the 
so-called time-effect problem, that is the long term data 
have less influence. 
III. THE EXPERIMENT OF USING DATA MINING 
METHOD TO INVADING DETECTING 
This article will carry out abnormal detecting 
experiment based on network using fuzzy associate 
rules mining and Apriori algorithm, and comparing 
analyzing. The experimental data come from http://iris-
cs.uml.edu:8080?We downloaded 3 groups network 
data on flows of tcpdump. And base stands for normal 
network data on flows, net1 contains network on flows 
of IP spoofing attacking, in which the intruder tries to 
obtain access to long distance host through guessing the 
IP serial number, net2 contains network on flows of 
copying port, attacking, scanning, in which the intruder 
tries to collect the associate network host and the 
service information it offers. 
A.  The pretreatment of experimental data 
The data is tcpdump type, tcpdump is the programs 
working at gateway, the gateway connects inner net and 
outer net, so it can obtain all packet data network 
connecting with outer net and all broadcasting packet 
data network, and only intercept the Header of message, 
without the contents of the data segment. Here is a 
classifying tcpdump data: 
 
15:10 ? 41.535855 2.0.256.256.2593>9.0.256.256. 
80?.ack 1163562564 win 16384 
15:10 ? 41.536404 2.0.256.256.1826>7.0.256.256. 
27383?.ack 0 win 16384 
15:10 ? 41.539437 7.0.256.256.27383>2.0.256.256. 
1826?.51 2 ?1024(512) ack 1 win 4096 
15:10 ? 41.539562 4.0.256.256.80>2.0.256.256. 
2608?. ack 438464421 win 9112 (DF) 
15:10 ? 41.541234 2.0.256.256.4305>6.0.256.256. 
119? P 1?38(37) ack 13 win 4096 
15:10 ? 41.542496 2.0.256.256.1826>7.0.256.256. 
27383?.ack 1024 win 16384 
 
850
Tcpdump data output like table 1: 
TABLE I.   TCPDUMP DATA OUTPUT 
TimeStramp Start time to connect 
Src Source IP address 
Des Destination IP address 
SrcPort Source port 
DesPort Destination port 
Seq Sequence number 
Ack acknowledgement number 
 
Data mining method dealing goals are commonly the 
database or structured data, but tcpump data can't use 
data mining method directly, so we must pretreatment 
with it. In traditional tcpdump there is many memos 
reflecting the same connection, we can combine many 
messages belonging to the same connection to one 
connection, one memo. So as to reduce the redundant 
rules caused in knowledge mining. So we can combine 
the data compact belonging to the same connections to 
one connecting memo through scanning every line data 
in tcpdump document. That is we make this operation to 
every TCP connection program: (1) Check to see if it 
connects normally, if not, record the error. (2) Detecting 
all the packet data network and ACK packet in data 
transmitting process, recording byte count coming from 
goal host. (3) In the process of ending , check the state 
of ending. For the connection of UDP, as UDP is 
agreement without connections, so it is easy to deal 
with, you can only take every packet as one connection 
memo. 
B. Rules mining and result comparison 
After the pretreatment with the data to traditional 
tcpdump data, we can use the algorithm method of the 
former article to mine the network log database. First 
divide the base document to 2 parts, 80 percents used to 
train data, 20 percent used to test data. After Associate 
Rules mining to training data, a lot of meaningless rules 
appeared, like: 
 
SND414<-REV 103 STATESF (4%,65%) 
SRC_ORT2630<-SND414(3%, 62%) 
 
The SND414 stands for the sponsor obtained 414 
bytes, REV103 stands for that sponsor obtain 103 bytes, 
SRC_ORT2630 stands for connecting Source Port is 
2630, STATESF stands for ending state is SF, These 
data can be obtained through checking connecting 
memos GiveBytes?GetBytes? SrcPort, StatusConn. 
Apparently, the outputting bytes has nothing to do with 
source port, the receiving bytes has nothing to do with 
ending state, in order to avoid producing a lot of useless 
rules, so we make further simplifying to the 
experimental data's attributes, only keep the source 
address, source port, destination address, goal port and 
connecting state 5 attributes to associate rules mining. 
Using fuzzy associate rules mining algorithm and 
Apriori algorithm to rules mining, suppose the support 
degree is s=4%, credit degree is c=80%, the mining to 
80% data and 20% data of the base file and also net1 
document and net2 document. The rules group we get 
are base80.rul, base20.rul, netl.rul, net2.rul, Compared 
base80.ru1with base20.rul, and netl.rul, net2.ru, we can 
find: Each rules obtained through associate rules mining 
reflect a special action customs of network, but the rules 
groups contains all actions features which meet 
supposed threshold value, so the similarity of rules 
groups reflects the similarity degree of different action 
customs among rule groups. Analyzing from theory 
80% of base data groups which is training data and 20% 
of base data groups which is testing data rule groups 
reflect normal action network on flows. So after mining 
the obtained similar and same rules are a lot, so as to the 
similarity between the two rule groups is very high. But 
the network on flows data which contains invading 
action data in net1 and net2 whose rules groups reflects 
the abnormal case. Compared the rules obtained from 
net1and net2 with base80.rul, the same rules are kind of 
small, so the similarity between rule group is small. 
Measured with the evaluation parameters mentioned 
above, we can get the comparison result like table 2: 
TABLE II.   TCPDUMP DATA OUTPUT 
Algorithm The number of rules false rate 
missing 
rate 
Running 
time 
Apriori 26377 36.2? 12.8? 135s 
Fuzzy associate 
rules mining 18036 20.3? 9.2? 82s 
 
The test result shows, the similarity of Apriori 
algorithm and training data is low, but the similarity 
between fuzzy associate rules mining algorithm and 
training data is a little high. From the number of rules 
obtained, we can see the number of rules obtained based 
on fuzzy associate rules algorithm is smaller and the 
time spent on it is also short , but the  false positive rate 
and rate of missing report is lower than Apriori 
algorithm. Apparently, this is the result of the work of 
the improved support and degree of confidence's genes. 
 
851
IV.  CONCLUSIONS 
This paper take improving detecting speed and 
accuracy as a goal, and adopt fuzzy associate rules 
mining method and Apriori algorithm to abnormal 
detecting experiment based on network, and improved 
the support and credit, and compared and analyzing the 
experiment result . The experiment result shows, using 
the fuzzy associate rules mining algorithm raised by this 
thesis, the detecting effective and accuracy has 
improved, shows satisfying result. 
REFERENCES 
 
[1] Fan Ming, Meng Xiaofeng etc, Data Mining Concepts and 
Techniques, Mechanical Industry Press, 2001. 
[2] Jianxiong Luo, Susan Bridges,“Mining Fuzzy Association Rules 
and Fuzzy Frequency Episodes for Intrusion Detection”, 
International Journal of Intelligent Systems, 2000,1 5(8) , pp. 
687 - 704. 
[3] Eleazar Eskin, “Anomaly Detection over Noisy Data Using 
Learned Probability Distributions”, in: Pat Lnagley ed. 
Proceedings of the Seventeenth International Conference on 
Machine Learning, Stanford, CA USA. 2000. CA USA: Morgan 
Kaufmann. 2000, pp. 255 - 262. 
[4] Karlton Sequeira, Mohammed J.Zaki. ADMIT: “Anomaly-
based data Mining for Intrusion”, In: Osmar Zaiane ed. 
Proceedings of the 8th ACM SIGKDD International Conference 
on Knowledge Discovery and Data Mining. Edmonton, Alberta, 
Canada. 2002. NY USA:ACM Press. 2002, pp. 386 - 395. 
[5] Wenke Lee, Wei Fan, Matthew Miller et al. “Toward Cost-
Sensitive Modeling for Intrusion Detection and Response”, 
Journal of Computer Security, 2002, 10(12), pp. 5 - 22. 
[6] Gao fei, Xie weixin, “Multiple Layered Concept Database 
Associate Rules Mining”, Computer science, 2001(6), pp. 85-
87. 
[7] Zhu xiaodong. Zheng Cheng. Le yi, “With improved Associate 
rules counting to build Intrusion Detection System mould”, the 
development of computer,2004(11) , pp. 139-141. 
[8] Danoel Barbara, Julia Couto, Sushil Jajodia, et al.aDAM: “A 
Testbed for Exploring the Use of Data Minig in Intrusion 
Detection”, In: Walid G. Aref, eds .SIGMOD 2001.Santa 
Barbara, CA. record 30(4), pp. 15 – 24. 
[9] Amitabha Das, Wee-Keong Ng, Yew-Kwong Woon.  “Rapid 
association rule mining”. Proceedings of the tenth international 
conference on Information and knowledge management, Oct,  
2001, pp. 474–481. 
[10] Zhu Huisheng, Ma Changxia. “Two improved algorithms of 
association rules”, Computer Applications and Software, Aug 
2006, pp. 117-119. 
[11] Zhang Yingjun, Xie Binhong, Zhao Hongyan.  “The 
Application of Association Rule Mining in Promoting Data 
Quality”, Journal of Taiyuan University of Technology, Jan 
2008, pp. 46-48. 
[12] Zeng Changjun. “Analysis and Design of Intrusion Detection 
Based on Data Mining of Association Rule”, Computer & 
Digital Engineering, 2008, pp. 91-94. 
[13] Zeng Xiaowen, Wang Huiyu. “Data Mining Algorithm of Fuzzy 
Multi-layered Association Rule”, Computer Development & 
Applications, 2008, pp. 59-61. 
[14] ZHAO Jitao, MA Li, WANG Xianjun, SHANG Guanglong. 
“An Adaptive Algorithm for Mining Fuzzy Association Rules”, 
Computer Technology and Development, May 2008, pp. 64-66
 
 
852
